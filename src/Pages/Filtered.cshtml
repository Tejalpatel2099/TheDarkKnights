@page
@model RamenRatings.WebSite.Pages.FilteredModel
@{
    ViewData["Title"] = "Filtered Results";
}

<h2>Filtered Results</h2>

<form method="get">
    <div class="form-group">
        <label for="SelectedStyle">Style</label>
        <select id="SelectedStyle" name="SelectedStyle" class="form-control">
            <option value="">-- All Styles --</option>
            @foreach (var style in Model.AllStyles)
            {
                <option value="@style" selected="@(style == Model.SelectedStyle)">
                    @style
                </option>
            }
        </select>
    </div>

    <div class="form-group mt-3">
        <label for="SelectedBrands">Brands</label>
        <select id="SelectedBrands" name="SelectedBrands" class="form-control" multiple>
            @foreach (var brand in Model.AllBrands)
            {
                <option value="@brand" selected="@(Model.SelectedBrands?.Contains(brand) == true)">
                    @brand
                </option>
            }
        </select>
    </div>

    <div class="mt-3">
        <button type="submit" class="btn btn-primary">Apply Filter</button>
        <a href="/Filtered" class="btn btn-outline-secondary">Clear Filters</a>
    </div>
</form>

<hr />

@if (Model.Products.Any())
{
    <div class="row row-cols-1 row-cols-md-3 g-4">
        @foreach (var product in Model.Products)
        {
            <a asp-page="/Details" asp-route-id="@product.Number" class="text-decoration-none text-dark">
                <div class="col">
                    <div class="card h-100 shadow-sm">
                        <img src="@product.img" class="card-img-top" alt="@product.Variety" style="height: 200px; object-fit: cover;">
                        <div class="card-body">
                            <h5 class="card-title">@product.Brand</h5>
                            <p class="card-text"><strong>@product.Variety</strong></p>
                            <p class="card-text">
                                <span class="text-muted">@product.Style</span><br />
                                <span class="text-muted">Country: @product.Country</span><br />
                                <span class="text-warning">Rating: @(product.Ratings?.FirstOrDefault() ?? 0)/5</span>
                            </p>
                        </div>
                    </div>
                </div>
            </a>
        }
    </div>
}
else
{
    <p>No products match the selected filters.</p>
}

<a class="btn btn-secondary mt-3" href="/">Back to Index</a>
