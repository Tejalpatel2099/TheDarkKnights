@page
@model RamenRatings.WebSite.Pages.Product.CreateModel
@{
    ViewData["Title"] = "Create New Ramen";
}

<h2 class="create-heading my-3">Create New Ramen Product</h2>

<div class="row my-3">
    <div class="col-md-12">
        <form method="post" enctype="multipart/form-data" class="create-form-wrapper">
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })

            <!-- Select from list of existing brands, with option to enter a new Brand -->
            <div class="form-group create-form-group">
                <label for="Brand">
                    Brand
                    @await Html.PartialAsync("_InfoTooltip", "The company or manufacturer that created the ramen.")
                </label>
                <select class="form-control create-input" id="Brand" name="Brand" required>
                    <option value="">Select a Brand</option>
                    @foreach (var brand in Model.ExistingBrands.Distinct())
                    {
                        <option value="@brand">@brand</option>
                    }
                    <option value="Other">Other</option>
                </select>
                <small class="form-text text-muted">You can select an existing brand or type a new one.</small>

                <div class="form-group create-form-group" id="newBrandGroup" style="display:none;">
                    <label for="NewBrand">Other Brand</label>
                    <input type="text" class="form-control create-input" id="NewBrand" name="NewBrand" placeholder="Enter a new brand" />
                </div>
                <div id="brand-error" class="text-danger mt-1" style="display: none;"></div>
            </div>

            <!-- Input Variety -->
            <div class="form-group create-form-group">
                <label for="Variety">
                    Variety
                    @await Html.PartialAsync("_InfoTooltip", "The specific flavor, type, or version of ramen product.")
                </label>
                <input asp-for="Variety" class="form-control create-input" placeholder="Enter variety" />
                <small class="form-text text-muted">You can write the variety of ramen.</small>
                <span asp-validation-for="Variety" class="text-danger"></span>
            </div>

            <!-- Select from list of existing styles -->
            <div class="form-group create-form-group">
                <label for="Style">
                    Style
                    @await Html.PartialAsync("_InfoTooltip", "The form or packaging of the ramen.")
                </label>
                <select class="form-control create-input" id="Style" name="Style" required>
                    <option value="">Select a Style</option>
                    @foreach (var style in Model.ExistingStyles.Distinct())
                    {
                        <option value="@style">@style</option>
                    }
                    <option value="Other">Other</option>
                </select>
                <small class="form-text text-muted">You can select an existing style or type a new one.</small>
                <div class="form-group create-form-group" id="newStyleGroup" style="display:none;">
                    <label for="NewStyle">Other Style</label>
                    <input type="text" class="form-control create-input" id="NewStyle" name="NewStyle" placeholder="Enter a new style" />
                </div>
                <div id="style-error" class="text-danger mt-1" style="display: none;"></div>
            </div>

            <!-- Country Selection -->
            <div class="form-group create-form-group">
                <label for="Country">
                    Country
                    @await Html.PartialAsync("_InfoTooltip", "The country where the ramen was sold.")
                </label>
                <select class="form-control create-input" id="Country" name="Country" required>
                    <option value="">Select a Country</option>
                    @foreach (var country in Model.Countries.Distinct())
                    {
                        <option value="@country">@country</option>
                    }
                </select>
                <small class="form-text text-muted">You can select an country related to the ramen.</small>
                <span asp-validation-for="Country" class="text-danger"></span>
            </div>

            <!-- Vegetarian Option -->
            <div class="form-group create-form-group">
                <label for="Vegetarian">Vegetarian</label>
                <select class="form-control create-input" id="Vegetarian" name="NewProduct.Vegetarian" required>
                    <option value="">Select an option</option>
                    @foreach (var option in Model.VegetarianOptions)
                    {
                        <option value="@option">@option</option>
                    }
                </select>
                <small class="form-text text-muted">You can select whether the ramen is vegetarian or non-vegetarian</small>
                <span asp-validation-for="NewProduct.Vegetarian" class="text-danger"></span>
            </div>

            <!-- Upload Image -->
            <div class="form-group create-form-group">
                <label for="Image">
                    Upload Image
                    @await Html.PartialAsync("_InfoTooltip", "A photo of the ramen packaging.")
                </label>
                <input type="file" class="form-control create-input" id="Image" name="Image" accept="image/*" required>
                <div id="image-error" class="text-danger mt-1" style="display: none;"></div>
                <small class="form-text text-muted mt-1">Only PNG, JPG, and GIF are supported up to 3 MB</small>
            </div>

            <!-- Rating Input -->
            <div class="form-group create-form-group">
                <label for="ramen-rating">How was your ramen experience?</label>
                <div class="create-rating-box d-flex align-items-center">
                    <div id="ramen-rating">
                        @for (int i = 1; i <= 5; i++)
                        {
                            <img src="/images/ramenpic.png"
                                 class="create-ramen-icon"
                                 data-value="@i"
                                 onclick="setRating(@i)"
                                 onmouseover="highlightRamen(@i)"
                                 onmouseout="resetRamen()" />
                        }
                    </div>
                    <div id="reaction-text" class="text-muted create-rating-reaction ml-3"></div>
                </div>
                <small class="form-text text-muted mt-2">Rate from 1 to 5 ramens</small>
                <input type="hidden" name="Rating" id="Rating" value="0" required />
            </div>

            <!-- Buttons -->
            <button type="button" class="btn btn-secondary create-btn" onclick="goBack()">Go Back</button>
            <button type="submit" class="btn btn-primary create-btn">Create Ramen</button>
            <div class="mb-5"></div>
        </form>
    </div>
</div>

@section Scripts
{
    <!-- Script to go back on the last page -->
    <script>
        function goBack() {
            window.history.back();
        }
    </script>
    <partial name="_ValidationScriptsPartial" />
}