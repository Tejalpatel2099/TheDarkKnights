@page
@model RamenRatings.WebSite.Pages.Product.CompareModel
@using RamenRatings.WebSite.Models
@{
    ViewData["Title"] = "Compare Ramen";
}

<h2 class="text-center mb-4">Compare Ramens</h2>

<!-- Form field dropdowns for comparing two ramens, listed by Brand then Variety-->
<form method="post">
    <div class="row mb-4">
        <div class="col-md-5">
            <!-- First Ramen dropdown to select -->
            <label for="Selected1">Select Ramen #1</label>
            <select class="form-control" id="Selected1" name="Selected1">
                @foreach (var ramen in Model.Products)
                {
                    <option value="@ramen.Number">@ramen.Brand @ramen.Variety</option>
                }
            </select>
        </div>

        <div class="col-md-2 text-center d-flex align-items-end justify-content-center">
            <button type="submit" class="btn btn-primary mt-2">Compare</button>
        </div>

        <div class="col-md-5">
            <!-- Second Ramen dropdown to select -->
            <label for="Selected2">Select Ramen #2</label>
            <select class="form-control" id="Selected2" name="Selected2">
                @foreach (var ramen in Model.Products)
                {
                    <option value="@ramen.Number">@ramen.Brand @ramen.Variety</option>
                }
            </select>
        </div>
    </div>
</form>

@if (Model.Ramen1 is ProductModel && Model.Ramen2 is ProductModel)
{
    <div class="row mt-5">
        <div class="col-md-6 text-center">
            <img src="@Model.Ramen1.img" alt="@Model.Ramen1.Variety" class="img-fluid rounded mb-2" width="250" height="250" />
            
            <!-- Output Brand for Ramen1 -->
            <p><strong>Brand:</strong> @Model.Ramen1.Brand</p>

            <!-- Output Variety for Ramen1 -->
            <p><strong>Variety:</strong> @Model.Ramen1.Variety</p>

            <!-- Output Style for Ramen1 -->
            <p><strong>Style:</strong> @Model.Ramen1.Style</p>

            <!-- Outputs Country for Ramen1 -->
            <p><strong>Country:</strong> @Model.Ramen1.Country</p>

            <!-- Outputs Vegetarian info for Ramen1 -->
            <p><strong>@Model.Ramen1.Vegetarian</strong> </p>
            
            <!-- Outputs ratings for Ramen1 as average of ratings array with # of ratings-->
            <p>
                <strong>Average Rating:</strong>
                @{
                    var ratings = Model.Ramen1.Ratings;
                    if ((ratings == null) == false && ratings.Length > 0)
                    {
                        double avg = ratings.Average();
                        <text>@($"{avg:F1} / 5 ({ratings.Length} rating{(ratings.Length == 1 ? "" : "s")})")</text>
                    }
                    else // If no ratings, print no ratings
                    {
                        @("No ratings yet")
                    }
                }
            </p>

            <p>
                <strong>Users Reviews:</strong><br/>
                @{
                    var feedbacks = Model.Ramen1.Feedback;
                    if ((feedbacks == null) == false && feedbacks.Length > 0)
                    {
                        @foreach (var feedback in feedbacks)
                        {
                            <text> @($"{feedback}") </text>
                            <br />
                        }
                    }
                    else // If no ratings, print no ratings
                    {
                        @("No feedback yet")
                    }
                }
            </p>
        </div>

        <div class="col-md-6 text-center">

            <img src="@Model.Ramen2.img" alt="@Model.Ramen2.Variety" class="img-fluid rounded mb-2" width="250" height="250" />

            <!-- Output Brand for Ramen2 -->
            <p><strong>Brand:</strong> @Model.Ramen2.Brand</p>

            <!-- Output Variety for Ramen2 -->
            <p><strong>Variety:</strong> @Model.Ramen2.Variety</p>

            <!-- Output Style for Ramen2 -->
            <p><strong>Style:</strong> @Model.Ramen2.Style</p>

            <!-- Output Country for Ramen2 -->
            <p><strong>Country:</strong> @Model.Ramen2.Country</p>

            <!-- Outputs Vegetarian info for Ramen1 -->
            <p><strong>@Model.Ramen2.Vegetarian</strong> </p>
            
            <!-- Outputs ratings for Ramen2 as average of ratings array with # of ratings -->
            <p>
                <strong>Average Rating:</strong>
                @{
                    var ratings2 = Model.Ramen2.Ratings;
                    if ((ratings2 == null) == false && ratings2.Length > 0)
                    {
                        double avg = ratings2.Average();
                        <text>@($"{avg:F1} / 5 ({ratings2.Length} rating{(ratings2.Length == 1 ? "" : "s")})")</text>
                    }
                    else // If no ratings, print no ratings
                    {
                        @("No ratings yet")
                    }
                }
            </p>

            <p>
                <strong>Users Reviews:</strong><br />
                @{
                    var feedbacksInRamen2 = Model.Ramen2.Feedback;
                    if ((feedbacksInRamen2 == null) == false && feedbacksInRamen2.Length > 0)
                    {
                        @foreach (var feedback2 in feedbacksInRamen2)
                        {
                            <text> @($"{feedback2}") </text>
                            <br />
                        }
                    }
                    else // If no ratings, print no ratings
                    {
                        @("No feedback yet")
                    }
                }
            </p>
        </div>
    </div>
}